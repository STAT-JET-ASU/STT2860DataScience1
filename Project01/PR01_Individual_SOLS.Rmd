---
title: "Project 1: Individual Coding & Analysis"
subtitle: "STT 2860 Intro to Data Mgmt & Visualization" 
author: "SOLUTIONS"
date: "`r format(Sys.time(), '%A, %B %d, %Y @ %I:%M %p')`"
output: 
  html_document: 
    theme: yeti
    highlight: textmate
    toc: true
    toc_depth: 4 
---

```{r globaloptions, include = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  comment = NA
)
```
***

### Packages Used

```{r}
library(tidyverse)
```

### Datasets Used

You can read the dataset descriptions and variable definitions [HERE](https://stat-jet-asu.github.io/Datasets/InstructorDescriptions/cappunish.html).

#### Capital Punishment Dataset

```{r readcappunish}
cpdata <- 
  read_csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/cappunish20231018.csv")
```

#### Size of Death Row Dataset

```{r readdeathrowsize}
drdata <- 
  read_csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/deathrowsize.csv")
```

#### Death Sentences in NC Dataset

```{r readsentencesNC}
ncdata <- 
  read_csv("https://raw.githubusercontent.com/STAT-JET-ASU/Datasets/master/Instructor/deathsentencesNC.csv")
```

### Plot #1: How Many States Have Capital Punishment? 

This plot uses the **Capital Punishment** dataset.

* Create a barplot for the variable `dp2`. 
* Use `color =` and `fill =` to format the bars.
* Use `labs()` to add a title and better axis labels.
* Apply a built-in theme from **ggplot2** or **ggthemes**.
* This plot should *not* have a visible legend anywhere on it.
* You may optionally add other formatting you deem useful.

```{r plot1}
ggplot(cpdata, aes(x = dp2, color = dp2, fill = dp2)) +
  geom_bar() +
  labs(
    title = "How many states have capital punishment?",
    x = "Has death penalty?",
    y = "number of states"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

### Plot #2: Capital Punishment By Region of the U.S.

This plot uses the **Capital Punishment** dataset.

* Create a barplot for the variable `region`. 
* Use `fill =` to shade each bar according to `dp2`.
* Change the `position =` to set each bar equal to 100%.
* Use `width =` to make the bars narrower than the default.
* Use `labs()` to add a title, axis labels, and a better legend label.
* Use `scale_fill_manual()` to choose a different color scheme for the plot. 
* Use `theme()` to move the legend to the bottom of the plot instead of the right
* You may optionally add a subtitle, caption, or ggplot2 built-in theme to the plot.

```{r plot2}
ggplot(cpdata, aes(x = region, fill = dp2)) +
  geom_bar(color = "black", position = "fill", width = 0.65) +
  labs(
    title = "Death Penalty by US Census Region",
    x = "US Census Region",
    y = "Proportion of States",
    fill = "Death penalty?"
  ) +
  scale_fill_manual(values = c("black", "darkgray", "lightgray")) +
  theme_linedraw() +
  theme(legend.position = "bottom")
```

### Plot #3: Number of Prisoners on Death Row

This plot uses the **Size of Death Row** dataset.

* Create a barplot for the total number of prisoners (y) in each year (x).
* Fill the bars using the variable `decade` and outline them all in black.
* Set the width of all the bars so there is no visible gap in between them.
* Scale the x-axis to include a tick mark at each decade (1970, 1980, etc).
* Scale the y axis so that it is numbered 0, 500, 1000, 1500, 2000, etc.
* Use `labs()` to add or change the title, axis labels, and legend label. 
* Use `theme()` to do the following:
    * center your title
    * set the plot background to white or blank
    * set all axis tick marks to transparent or blank
    * set the major x-axis gridlines to transparent or blank
    * set the major y-axis gridlines to light gray
* You may optionally change the color scheme used for the bars in your plot

```{r plot3}
ggplot(drdata, aes(x = year, y = total, fill = decade)) +
  geom_col(color = "black") +
  scale_x_continuous(breaks = seq(from = 1960, to = 2030, by = 10)) +
  scale_y_continuous(breaks = seq(from = 0, to = 4000, by = 500)) +
  labs(
    title = "Number of Prisoners on Death Row Per Year",
    x = "Year",
    y = "Number of Prisoners",
    fill = "Decade"
  ) +
  theme(
    plot.title = element_text(hjust = 0.5),
    plot.background = element_rect(fill = "white"),
    axis.ticks = element_blank(),
    panel.grid = element_blank(),
    panel.grid.major.y = element_line(color = "lightgray")
  )
```

### Plot #4: Number of Executions Since 1976

This plot uses the **Capital Punishment** dataset.

* Create a violin plot for the variable `post1976` (use `y = 0`).
* Add a boxplot layer and set `width` to fit inside the violin plot.
* Fill each plot with a color of your choice (be colorblind-aware!).
* Scale the x-axis of the plot so that it counts in increments of 25.
* Remove all y-axis markings/gridlines using `scale_y_continuous()`.
* Use `annotate()` to identify the large outlier using the state name.
* Add a title and x-axis label (make sure we know it's all states *and* DC).
* Add the built-in theme `theme_linedraw()` or `theme_minimal` to the plot.

Hint: You can use the `NULL` vector in functions like `scale_y_continuous()`

```{r plot4}
ggplot(cpdata, aes(x = post1976, y = 0)) +
  geom_violin(fill = "skyblue") +
  geom_boxplot(fill = "orange", width = 0.1) +
  scale_x_continuous(breaks = seq(0, 800, 25)) +
  scale_y_continuous(breaks = NULL, name = NULL) +
  labs(
    title = "Number of Executions in Each State and D.C. Since 1976",
    x = "Total Number of Executions"
  ) +
  theme_minimal() +
  annotate("label", x = 575, y = 0.1, label = "Texas")
```

### Plot #5: Death Sentences in NC Since 1976

This plot uses the **Death Sentences in NC** dataset.

Create a time series plot of death sentences in North Carolina. Use three geometries on this plot: `geom_area()`, `geom_line()` and `geom_point()`. Use `geom_vline()` to add a vertical line for 2001. The significance of this year is that the General Assembly modified the death penalty statute in several ways, including giving prosecutors the discretion to *not* seek the death penalty in cases where it previously would have been mandatory. Title, label, and format your plot in such a way that the information it conveys would be clear to the reader (i.e., the plot is reasonably stand-alone).

```{r plot5}
ggplot(ncdata, aes(x = year, y = sentences)) +
  geom_area(fill = "skyblue", alpha = 0.5) +
  geom_line() +
  geom_point(size = 3, color = "blue") +
  geom_vline(xintercept = 2001, linetype = "dashed") +
  scale_x_continuous(
    breaks = seq(1975, 2025, by = 5), 
    limits = c(1975, 2025),
    ) +
  labs(
    title = "Number of Death Sentences Issued in NC Since 1976",
    x = "Year",
    y = "Number of Sentences",
    caption = "significant modifications were made to NC's death penalty statute in 2001"
  ) +
  theme_minimal()
```

### Information Conveyed by Your Plots

List two pieces of information you can learn or comparisons you can make from each plot above.

#### Plot #1 (Example Answers)

* Item 1: Three states technically have the death penalty, but it is in moratorium (on hold).
* Item 2: If you go strictly by yes/no, then a majority of states in the U.S. have the death penalty.
* Item 3: If you take moratoriums into consideration, the other states are evenly split on the death penalty.

#### Plot #2 (Example Answers)

* Item 1: Both the northeast and west have at least one state with a death penalty moratorium.
* Item 2: The south and west both currently have a majority of states with the death penalty.
* Item 3: The northeast region essentially has no states with an active death penalty.
* Item 4: The midwest is split 50/50 in terms of states having the death penalty.
* Item 5: This plot shows clear regional differences in the death penalty.

#### Plot #3 (Example Answers)

* Item 1: In 2000, there were about 7 times the number of prisoners on death row as in 1970.
* Item 2: The number of prisoners on death row seems to have peaked in the early 2000s.
* Item 3: There is a near-linear increase in prisoners on death row from 1980-2000.
* Item 4: The number of prisoners on death row has been decreasing since 2000.
* Item 5: The fewest number of death row prisoners was in the early 1970s.

#### Plot #4 (Example Answers)

* Item 1: Texas has executed four to five times as many people as the next largest state; major outlier!
* Item 2: About 75% of states have executed 25 or fewer people (the top of the boxplot is @ 25).
* Item 3: The vast majority of states in the U.S. have executed very few people since 1976

#### Plot #5 (Example Answers)

* Item 1: Across time, the year with the most death sentences handed out in NC was 1995.
* Item 2: There are generally fewer death sentences given after the 2001 legislation.
* Item 3: Six of the twenty years since 2001 have had zero death sentences given.
* Item 4: There was a notable increase in death sentences in the early 90s.

***
```{r}
sessionInfo()
```
